<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Docker Docs - Docker Desktop Releases</title>
    <link>{{ .Permalink }}</link>
    <description>Docker Desktop release announcements</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>{{ .Site.LanguageCode | default "en" }}</language>
    <lastBuildDate>{{ now.Format "Mon, 02 Jan 2006 15:04:05 -0700" | safeHTML }}</lastBuildDate>
    <atom:link href="{{ .Permalink }}index.xml" rel="self" type="application/rss+xml" />

    {{ $content := .RawContent }}
    {{ $sections := split $content "## " }}
    {{ range $index, $section := after 1 $sections }}
      {{ $lines := split $section "\n" }}
      {{ $title := index $lines 0 }}
      {{/* Only process sections that start with a version number pattern like "4.46.0" */}}
      {{ if and $title (findRE `^\d+\.\d+\.\d+` $title) }}
        {{ $releaseDate := "" }}
        {{ $sectionContent := $section }}
        
        {{/* Extract release date from release-date shortcode */}}
        {{ range $lineIndex, $line := $lines }}
          {{ if in $line "release-date" }}
            {{ $dateRegex := findRE `date="([0-9]{4}-[0-9]{2}-[0-9]{2})"` $line }}
            {{ if $dateRegex }}
              {{ $fullMatch := index $dateRegex 0 }}
              {{ $dateOnly := replaceRE `date="([0-9]{4}-[0-9]{2}-[0-9]{2})"` `$1` $fullMatch }}
              {{ $releaseDate = $dateOnly }}
            {{ end }}
          {{ end }}
        {{ end }}
        
        {{/* Get the next version section to know where this one ends */}}
        {{ $nextVersionIndex := 0 }}
        {{ range $nextIndex, $nextSection := after (add $index 1) $sections }}
          {{ $nextLines := split $nextSection "\n" }}
          {{ $nextTitle := index $nextLines 0 }}
          {{ if and $nextTitle (findRE `^\d+\.\d+\.\d+` $nextTitle) }}
            {{ $nextVersionIndex = add $nextIndex $index 1 }}
            {{ break }}
          {{ end }}
        {{ end }}
        
        {{/* If we found a next version, truncate content there */}}
        {{ if gt $nextVersionIndex 0 }}
          {{ $remainingSections := first (sub $nextVersionIndex $index) (after $index $sections) }}
          {{ $sectionContent = delimit $remainingSections "## " }}
          {{ $sectionContent = printf "## %s" $sectionContent }}
        {{ end }}
        
        {{/* Clean up shortcodes from content for RSS */}}
        {{ $cleanContent := replaceRE `\{\{<[^>]*>\}\}` "" $sectionContent }}
        
        {{/* Parse release date for RSS pubDate format */}}
        {{ $pubDate := now.Format "Mon, 02 Jan 2006 15:04:05 -0700" }}
        {{ if $releaseDate }}
          {{ $parsedDate := time $releaseDate }}
          {{ $pubDate = $parsedDate.Format "Mon, 02 Jan 2006 15:04:05 -0700" }}
        {{ end }}
        
        <item>
          <title>Docker Desktop {{ $title }}</title>
          <link>{{ $.Permalink }}#{{ $title | urlize }}</link>
          <pubDate>{{ $pubDate | safeHTML }}</pubDate>
          <guid>{{ $.Permalink }}#{{ $title | urlize }}</guid>
          <description>{{ $cleanContent | markdownify | html }}</description>
        </item>
      {{ end }}
    {{ end }}
  </channel>
</rss>